@{
    ViewBag.Title = "Dashboard de Ventas";
}

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="container-fluid py-2">
    <div class="card">
        <div class="card-body">


            <h2 class="mb-4 text-primary">Dashboard de Ventas</h2>

            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="card shadow-sm text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">Ventas Hoy</h5>
                            <p class="display-6 fw-bold" id="ventasHoy">0</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card shadow-sm text-center">
                        <div class="card-body">
                            <h5 class="card-title text-info">Total Productos</h5>
                            <p class="display-6 fw-bold" id="totalProductos">0</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card shadow-sm text-center">
                        <div class="card-body">
                            <h5 class="card-title text-danger">Ingresos Mensuales</h5>
                            <p class="display-6 fw-bold" id="ingresosMensuales">0</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-8 mb-4">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Ventas por Mes</h5>
                            <canvas id="ventasMesChart" height="120"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 mb-4">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Top Productos</h5>
                            <ul class="list-group" id="topProductos">
                                <!-- Productos se renderizan aquí -->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Datos de prueba
    var dashboardData = {
        ventasHoy: 17,
        totalProductos: 12,
        clientesActivos: 5,
        ingresosMensuales: 1250.75,
        ventasPorMes: [320, 450, 390, 600, 700, 800, 950, 1100, 900, 1200, 1300, 1250],
        meses: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
        topProductos: [
            { nombre: "Manzanas orgánicas", ventas: 120 },
            { nombre: "Pan integral", ventas: 95 },
            { nombre: "Leche de almendra", ventas: 80 },
            { nombre: "Café premium", ventas: 75 },
            { nombre: "Queso artesanal", ventas: 60 }
        ]
    };

    // Renderizar métricas
    $("#ventasHoy").text(dashboardData.ventasHoy);
    $("#totalProductos").text(dashboardData.totalProductos);
    $("#clientesActivos").text(dashboardData.clientesActivos);
    $("#ingresosMensuales").text("€ " + dashboardData.ingresosMensuales.toFixed(2));

    // Renderizar top productos
    $.each(dashboardData.topProductos, function(i, prod) {
        $("#topProductos").append(
            '<li class="list-group-item d-flex justify-content-between align-items-center">' +
            prod.nombre +
            '<span class="badge bg-primary rounded-pill">' + prod.ventas + '</span>' +
            '</li>'
        );
    });

    // Gráfico de ventas por mes
    var ctx = document.getElementById('ventasMesChart').getContext('2d');
    var ventasMesChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: dashboardData.meses,
            datasets: [{
                label: 'Ventas (€)',
                data: dashboardData.ventasPorMes,
                borderColor: 'rgba(13, 110, 253, 0.8)',
                backgroundColor: 'rgba(13, 110, 253, 0.1)',
                fill: true,
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>